---
// src/pages/store/[...page].astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import Container from "../../components/Container.astro";
import HeroInner from "../../components/PageBanner.astro";
import type { Product } from "../../lib/getProducts";
import { getProducts } from "../../lib/getProducts";

interface PageProps {
  data: Product[];
  url: {
    prev?: string;
    next?: string;
  };
}

export async function getStaticPaths({ paginate }: { paginate: any }) {
  const products = await getProducts();
  return paginate(products, { pageSize: 1 }); // I bumped to 6 per page (adjust if needed)
}

const { page }: { page: PageProps } = Astro.props;

const title = "Our Store";
const desc = "";
const image = "/hero-inner.webp";
---

<BaseLayout title={title}>
  <HeroInner title={title} desc={desc} image={image} />

  <Container>
    <!-- Products grid -->
    <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
      {
        page.data.map((p) => (
          <a
            href={`/store/${p.slug}`}
            class="rounded border p-4 hover:shadow-lg"
          >
            <img
              src={p.image}
              alt={p.title}
              class="h-48 w-full rounded object-cover"
            />
            <h2 class="mt-2 text-lg font-bold">{p.title}</h2>
            <p class="font-semibold text-gray-700">${p.price}</p>
          </a>
        ))
      }
    </div>

    <!-- Flowbite Pagination -->
    <div class="mt-8 flex justify-center">
      <nav aria-label="Page navigation example">
        <ul class="inline-flex h-10 -space-x-px text-base">
          {
            page.url.prev ? (
              <li>
                <a
                  href={page.url.prev}
                  class="ms-0 flex h-10 items-center justify-center rounded-s-lg border border-e-0 border-gray-300 bg-white px-4 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700"
                >
                  Previous
                </a>
              </li>
            ) : null
          }

          {
            page.url.next ? (
              <li>
                <a
                  href={page.url.next}
                  class="flex h-10 items-center justify-center rounded-e-lg border border-gray-300 bg-white px-4 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700"
                >
                  Next
                </a>
              </li>
            ) : null
          }
        </ul>
      </nav>
    </div>
  </Container>
</BaseLayout>
